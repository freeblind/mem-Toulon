<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TD UE 3.2 S1 - Version Interactive</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg: #07101a;
            --bg-card: #0b1220;
            --bg-input: #0f172a;
            --accent: #60a5fa;
            --success: #22c55e;
            --error: #ef4444;
            --warning: #f59e0b;
            --text: #e5e7eb;
            --text-muted: #9ca3af;
            --border: #1f2937;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 25px;
        }

        h1 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2em;
            color: var(--accent);
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 0.95em;
        }

        .warning {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--error);
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            font-size: 0.9em;
        }

        .info-box {
            background: rgba(96, 165, 250, 0.1);
            border-left: 4px solid var(--accent);
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            font-size: 0.9em;
        }

        .hors-td {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid var(--warning);
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            font-size: 0.9em;
        }

        .hors-td::before {
            content: "üí° HORS TD - ";
            font-weight: 700;
            color: var(--warning);
        }

        .progress-bar {
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), #3b82f6);
            width: 0%;
            transition: width 0.3s;
        }

        .tabs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 25px;
        }

        .tab-btn {
            padding: 12px 18px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text);
            border-radius: 8px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8em;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            border-color: var(--accent);
            background: rgba(96, 165, 250, 0.1);
        }

        .tab-btn.active {
            background: var(--accent);
            color: var(--bg);
            border-color: var(--accent);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 25px;
        }

        .section-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.3em;
            color: var(--accent);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
        }

        .question {
            background: rgba(15, 23, 42, 0.5);
            border-left: 4px solid var(--accent);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .question-number {
            display: inline-block;
            background: var(--accent);
            color: var(--bg);
            padding: 4px 12px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85em;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 1.05em;
            margin: 10px 0;
            line-height: 1.6;
        }

        .input-group {
            margin: 15px 0;
        }

        .input-field {
            width: 100%;
            padding: 12px;
            background: var(--bg-input);
            border: 2px solid var(--border);
            border-radius: 6px;
            color: var(--text);
            font-family: 'Inter', sans-serif;
            font-size: 0.95em;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent);
            background: var(--bg);
        }

        .input-field.ok {
            border-color: var(--success);
            background: rgba(34, 197, 94, 0.1);
        }

        .input-field.ko {
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.1);
        }

        textarea.input-field {
            min-height: 100px;
            resize: vertical;
        }

        .correction-inline {
            display: none;
            background: rgba(96, 165, 250, 0.05);
            border: 1px solid var(--accent);
            border-radius: 6px;
            padding: 12px;
            margin-top: 10px;
            animation: slideDown 0.3s;
        }

        .correction-inline.show {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .correction-inline .correction-label {
            color: var(--accent);
            font-weight: 700;
            font-size: 0.85em;
            margin-bottom: 5px;
            font-family: 'JetBrains Mono', monospace;
        }

        .correction-inline.ok {
            border-color: var(--success);
            background: rgba(34, 197, 94, 0.05);
        }

        .correction-inline.ok .correction-label {
            color: var(--success);
        }

        .correction-inline.ko {
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.05);
        }

        .correction-inline.ko .correction-label {
            color: var(--error);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: var(--bg-input);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 12px;
            border: 1px solid var(--border);
            text-align: left;
        }

        th {
            background: var(--bg);
            color: var(--accent);
            font-weight: 700;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .btn {
            padding: 12px 24px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--accent);
            color: var(--bg);
            border-color: var(--accent);
        }

        .btn-primary:hover {
            background: #3b82f6;
            border-color: #3b82f6;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text);
        }

        .btn-secondary:hover {
            border-color: var(--accent);
            background: rgba(96, 165, 250, 0.1);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.8em;
        }

        .option-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 10px 0;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 12px;
            background: var(--bg-input);
            border: 2px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            border-color: var(--accent);
            background: rgba(96, 165, 250, 0.05);
        }

        .option input[type="radio"] {
            margin-right: 10px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .option.ok {
            border-color: var(--success);
            background: rgba(34, 197, 94, 0.1);
        }

        .option.ko {
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.1);
        }

        /* Sch√©ma interactif */
        .schema-container {
            position: relative;
            max-width: 900px;
            margin: 20px auto;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 12px;
            padding: 20px;
        }

        .schema-wrapper {
            position: relative;
            width: 100%;
            display: inline-block;
        }

        .schema-img {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 8px;
        }

        .schema-point {
            position: absolute;
            width: 40px;
            height: 40px;
            background: var(--accent);
            color: var(--bg);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid var(--bg);
            box-shadow: 0 3px 10px rgba(0,0,0,0.5);
            z-index: 100;
            transform: translate(-50%, -50%);
        }

        .schema-point:hover {
            transform: translate(-50%, -50%) scale(1.3);
            background: #3b82f6;
            box-shadow: 0 5px 15px rgba(96, 165, 250, 0.7);
            z-index: 101;
        }

        .schema-point.answered {
            background: var(--success);
        }

        /* Mode Debug */
        .debug-mode {
            border: 3px solid var(--warning) !important;
        }

        .debug-panel {
            background: rgba(245, 158, 11, 0.1);
            border: 2px solid var(--warning);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }

        .debug-panel.active {
            display: block;
        }

        .debug-coords {
            background: var(--bg-input);
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
        }

        .debug-info {
            color: var(--warning);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .coord-line {
            padding: 5px;
            margin: 3px 0;
            background: rgba(255,255,255,0.03);
            border-radius: 4px;
        }

        .coord-line:hover {
            background: rgba(96, 165, 250, 0.1);
        }

        .schema-point.debug-active {
            background: var(--warning);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
        }

        .click-indicator {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--error);
            border-radius: 50%;
            pointer-events: none;
            transform: translate(-50%, -50%);
            animation: fadeOut 1s;
        }

        @keyframes fadeOut {
            0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(2); }
        }

        .schema-input-group {
            margin: 15px 0;
            padding: 15px;
            background: rgba(15, 23, 42, 0.3);
            border-radius: 8px;
        }

        .score-display {
            background: var(--bg-card);
            border: 2px solid var(--accent);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            margin: 30px 0;
            display: none;
        }

        .score-display.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        .score-number {
            font-size: 4em;
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent);
            font-weight: 700;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.5em;
            }
            
            .tabs {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .schema-point {
                width: 30px;
                height: 30px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö TD UE 3.2 S1 - Version Interactive</h1>
            <p class="subtitle">Physique appliqu√©e et technologie en imagerie radiologique</p>
            <p class="subtitle" style="margin-top: 5px;">IFPVPS - 2024/2025 - Corrections int√©gr√©es sous chaque r√©ponse</p>
            
            <div class="warning">
                ‚ö†Ô∏è <strong>Important :</strong> Apr√®s avoir rempli un champ, cliquez sur "‚úì V√©rifier" pour voir la correction appara√Ætre directement en dessous !
            </div>
            
            <div class="info-box">
                üí° <strong>Mode d'emploi :</strong> 
                <br>‚Ä¢ Remplissez les champs de r√©ponse
                <br>‚Ä¢ Cliquez sur "‚úì V√©rifier" apr√®s chaque question
                <br>‚Ä¢ La correction s'affiche automatiquement sous votre r√©ponse
                <br>‚Ä¢ Pour le sch√©ma du tube RX : cliquez sur les num√©ros puis remplissez les champs
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('production')">Production RX</button>
            <button class="tab-btn" onclick="switchTab('interactions')">Interactions</button>
            <button class="tab-btn" onclick="switchTab('tube')">Tube RX + Sch√©ma</button>
            <button class="tab-btn" onclick="switchTab('doses')">Doses</button>
            <button class="tab-btn" onclick="switchTab('osteo')">Ost√©odensitom√©trie</button>
            <button class="tab-btn" onclick="switchTab('spectrale')">Analyse Spectrale</button>
        </div>

        <!-- PRODUCTION DES RAYONS X -->
        <div id="production" class="tab-content active">
            <div class="section">
                <h2 class="section-title">I. Production des Rayons X</h2>
                
                <div class="question">
                    <span class="question-number">QUESTION 1</span>
                    <p class="question-text"><strong>1. D√©finissez les rayons X</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="def_rx" placeholder="Votre r√©ponse..." rows="4"></textarea>
                        <div class="correction-inline" id="corr_def_rx">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong> Ondes √©lectromagn√©tiques (OEM) √† haute fr√©quence, longueur d'onde entre 5 picom√®tres et 10 nanom√®tres, ce qui les classe dans les rayonnements ionisants. Les OEM se propagent en ligne droite et sont caract√©ris√©es par leur longueur d'onde, fr√©quence et √©nergie par photon.</p>
                        </div>
                    </div>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>2. D√©finissez les rayonnements ionisants</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="def_ionisant" placeholder="Votre r√©ponse..." rows="4"></textarea>
                        <div class="correction-inline" id="corr_def_ionisant">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong> Les rayonnements (X et gamma) sont dits ionisants car ils √©mettent des rayons d'√©nergie suffisante pour transformer les atomes qu'ils traversent en ions, pouvant rendre instable la mati√®re. Un atome instable cherche √† se stabiliser en √©mettant diff√©rents rayonnements (Alpha, B√©ta-, B√©ta+, RX et Gamma).</p>
                        </div>
                    </div>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>3. Pr√©cisez la diff√©rence entre les rayons X et Gamma</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="diff_gamma" placeholder="Votre r√©ponse..." rows="3"></textarea>
                        <div class="correction-inline" id="corr_diff_gamma">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong> Leur diff√©rence vient de leur mode de production :</p>
                            <ul style="margin-left: 20px; margin-top: 5px;">
                                <li>Les rayons X prennent naissance dans le nuage √©lectronique de l'atome</li>
                                <li>Les rayons Gamma sont produits dans la structure (noyau) de l'atome</li>
                            </ul>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion(1)">‚úì V√©rifier Q1</button>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION 2</span>
                    <p class="question-text"><strong>Modes de production des rayons X</strong></p>
                    
                    <p><strong>1. Compl√©tez la phrase :</strong></p>
                    <p style="margin: 10px 0;">La production des RX fait suite √† une interaction d'<input type="text" class="input-field" id="prod_1" style="display: inline-block; width: 200px; margin: 0 5px;" placeholder="..."> de forte √©nergie cin√©tique contre une <input type="text" class="input-field" id="prod_2" style="display: inline-block; width: 250px; margin: 0 5px;" placeholder="..."></p>
                    <div class="correction-inline" id="corr_prod_phrase">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong> √©lectrons / cible m√©tallique dense</p>
                    </div>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>2. Citez les 2 modes de production des rayons X</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="modes_prod" placeholder="Mode 1 et Mode 2..." rows="3"></textarea>
                        <div class="correction-inline" id="corr_modes_prod">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong></p>
                            <ul style="margin-left: 20px;">
                                <li><strong>1. Interaction √©lectron-noyau</strong> (effet de freinage) - environ 99% des RX</li>
                                <li><strong>2. Interaction √©lectron-√©lectron</strong> (r√©arrangement √©lectronique) - environ 1% des RX</li>
                            </ul>
                        </div>
                    </div>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>3. Pr√©cisez le ph√©nom√®ne produisant majoritairement les rayons X</strong></p>
                    <div class="input-group">
                        <input type="text" class="input-field" id="majoritaire" placeholder="Ph√©nom√®ne majoritaire...">
                        <div class="correction-inline" id="corr_majoritaire">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong> Interaction √©lectron-noyau (effet de freinage) - produit environ 99% des RX en radiologie diagnostique.</p>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion(2)">‚úì V√©rifier Q2</button>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION 3</span>
                    <p class="question-text"><strong>R√©arrangement √©lectronique (Interaction √©lectron-√©lectron)</strong></p>
                    
                    <p><strong>Explicitez ce ph√©nom√®ne :</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="rearra_expl" placeholder="Expliquez le m√©canisme..." rows="5"></textarea>
                        <div class="correction-inline" id="corr_rearra_expl">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong> Quand l'√©nergie de l'√©lectron incident > √©nergie de liaison d'un √©lectron de l'atome ‚Üí expulsion de cet √©lectron. L'atome se r√©organise par cascade √©lectronique (r√©arrangement √©lectronique), avec √©mission de rayons X correspondant √† la diff√©rence d'√©nergie de liaison entre les deux couches √©lectroniques.</p>
                            <div class="hors-td" style="margin-top: 10px;">
                                Les raies caract√©ristiques principales sont nomm√©es K-alpha, K-beta, L-alpha, etc. En diagnostic, ces raies sont surtout visibles √† basse tension (< 70 kV) et repr√©sentent environ 1% du spectre total.
                            </div>
                        </div>
                    </div>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>Quel type de spectre produit ce ph√©nom√®ne ?</strong></p>
                    <div class="option-group">
                        <label class="option">
                            <input type="radio" name="spectre_type" value="raies">
                            Spectre de raies (discret)
                        </label>
                        <label class="option">
                            <input type="radio" name="spectre_type" value="continu">
                            Spectre continu
                        </label>
                    </div>
                    <div class="correction-inline" id="corr_spectre_type">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong> Spectre de raies - chaque raie correspond √† une transition √©lectronique sp√©cifique entre deux couches.</p>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion(3)">‚úì V√©rifier Q3</button>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION 4</span>
                    <p class="question-text"><strong>Effet de freinage (Interaction √©lectron-noyau)</strong></p>
                    
                    <p><strong>Explicitez ce ph√©nom√®ne :</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="freinage_expl" placeholder="Expliquez le m√©canisme..." rows="5"></textarea>
                        <div class="correction-inline" id="corr_freinage_expl">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong> Passage d'un √©lectron au voisinage d'un noyau ‚Üí il est attir√© par ce dernier ‚Üí il subit une d√©viation importante et perd une partie de son √©nergie sous forme de rayonnement √©lectromagn√©tique dit "rayonnement de freinage".</p>
                            <div class="hors-td" style="margin-top: 10px;">
                                L'efficacit√© de production des RX par freinage est tr√®s faible : environ 1% de l'√©nergie des √©lectrons est convertie en RX, le reste (99%) est dissip√© sous forme de chaleur dans l'anode. C'est pourquoi le refroidissement de l'anode est crucial.
                            </div>
                        </div>
                    </div>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>Quel type de spectre produit ce ph√©nom√®ne ?</strong></p>
                    <div class="option-group">
                        <label class="option">
                            <input type="radio" name="spectre_freinage" value="raies">
                            Spectre de raies
                        </label>
                        <label class="option">
                            <input type="radio" name="spectre_freinage" value="continu">
                            Spectre continu
                        </label>
                    </div>
                    <div class="correction-inline" id="corr_spectre_freinage">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong> Spectre continu - car les √©lectrons peuvent perdre des quantit√©s d'√©nergie variables selon leur trajectoire. L'√©nergie maximale des RX √©mis = √©nergie de l'√©lectron incident.</p>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion(4)">‚úì V√©rifier Q4</button>
                </div>
            </div>
        </div>

        <!-- INTERACTIONS RX-MATI√àRE -->
        <div id="interactions" class="tab-content">
            <div class="section">
                <h2 class="section-title">II. Interactions Rayons X - Mati√®re</h2>
                
                <div class="question">
                    <span class="question-number">QUESTION 10</span>
                    <p class="question-text"><strong>Image radiante et att√©nuation</strong></p>
                    
                    <p><strong>1. D√©finissez l'image radiante :</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="img_radiante" placeholder="Votre d√©finition..." rows="3"></textarea>
                        <div class="correction-inline" id="corr_img_radiante">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong> L'image radiante est form√©e par les diff√©rences d'att√©nuation du faisceau de RX dans les milieux travers√©s, se traduisant au niveau de l'image radiologique par des diff√©rences de niveaux de gris.</p>
                        </div>
                    </div>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>2. Citez les 3 facteurs influant l'att√©nuation des RX :</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="facteurs_att" placeholder="Les 3 facteurs..." rows="4"></textarea>
                        <div class="correction-inline" id="corr_facteurs_att">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong></p>
                            <ul style="margin-left: 20px;">
                                <li><strong>1.</strong> L'√©paisseur des objets travers√©s</li>
                                <li><strong>2.</strong> Leur composition physique et chimique (densit√©, num√©ro atomique Z)</li>
                                <li><strong>3.</strong> L'√©nergie des rayons X</li>
                            </ul>
                            <div class="info-box" style="margin-top: 10px;">
                                üìê <strong>Loi de Beer-Lambert :</strong> I = I‚ÇÄ √ó exp(-Œºx)<br>
                                ‚Ä¢ I = fluence photonique sortante<br>
                                ‚Ä¢ I‚ÇÄ = fluence photonique incidente<br>
                                ‚Ä¢ Œº = coefficient d'att√©nuation (d√©pend de Z et E)<br>
                                ‚Ä¢ x = √©paisseur travers√©e
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion(10)">‚úì V√©rifier Q10</button>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION 11</span>
                    <p class="question-text"><strong>Effet Photo√©lectrique</strong></p>
                    
                    <div class="input-group">
                        <textarea class="input-field" id="photo_expl" placeholder="M√©canisme de l'effet photo√©lectrique..." rows="5"></textarea>
                        <div class="correction-inline" id="corr_photo_expl">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong> Se produit quand un photon X c√®de TOUTE son √©nergie √† un √©lectron de l'atome. Le transfert d'√©nergie n'est possible que si l'√©nergie de liaison de l'√©lectron < √©nergie du photon X incident.</p>
                            <p style="margin-top: 10px;">L'atome ionis√© et excit√© revient √† l'√©quilibre par r√©arrangement √©lectronique, s'accompagnant de l'√©mission d'un photon de fluorescence (faible √©nergie, r√©absorb√© localement).</p>
                            <div class="hors-td" style="margin-top: 10px;">
                                L'effet photo√©lectrique est pr√©pond√©rant aux <strong>basses tensions (50-70 kV)</strong> et dans les <strong>milieux denses</strong> (os, calcifications, iode). Il est responsable du contraste naturel en radiologie, mais augmente la dose au patient car l'√©nergie est totalement absorb√©e.
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion(11)">‚úì V√©rifier Q11</button>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION 12</span>
                    <p class="question-text"><strong>Effet Compton</strong></p>
                    
                    <div class="input-group">
                        <textarea class="input-field" id="compton_expl" placeholder="M√©canisme de l'effet Compton..." rows="5"></textarea>
                        <div class="correction-inline" id="corr_compton_expl">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong> R√©sulte de l'interaction entre le photon X incident et un √©lectron faiblement li√© d'un atome (√©nergie de liaison n√©gligeable - √©lectrons des couches p√©riph√©riques).</p>
                            <p style="margin-top: 10px;">Lors de l'interaction, le photon X dispara√Æt :</p>
                            <ul style="margin-left: 20px;">
                                <li>Une partie de son √©nergie est c√©d√©e √† l'√©lectron √©ject√© (√©lectron Compton)</li>
                                <li>L'autre partie est transmise sous forme d'un nouveau photon (photon diffus√©)</li>
                            </ul>
                            <div class="hors-td" style="margin-top: 10px;">
                                ‚ö†Ô∏è L'effet Compton est pr√©pond√©rant aux <strong>hautes tensions (> 100 kV)</strong> et dans les <strong>milieux peu denses</strong> (graisse, tissus mous). C'est la principale source de rayonnement diffus√© qui d√©grade le contraste de l'image et augmente l'exposition du personnel ‚Üí utilisation de grilles anti-diffusion.
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion(12)">‚úì V√©rifier Q12</button>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION 13</span>
                    <p class="question-text"><strong>Tableau comparatif Photo√©lectrique vs Compton</strong></p>
                    <table>
                        <tr>
                            <th>Affirmation</th>
                            <th>Votre r√©ponse</th>
                        </tr>
                        <tr>
                            <td>Effet pr√©pond√©rant aux <strong>basses tensions</strong> (50-70 kV)</td>
                            <td><input type="text" class="input-field" id="comp_1" placeholder="Photo ou Compton ?"></td>
                        </tr>
                        <tr>
                            <td>Effet pr√©pond√©rant aux <strong>hautes tensions</strong> (> 100 kV)</td>
                            <td><input type="text" class="input-field" id="comp_2" placeholder="Photo ou Compton ?"></td>
                        </tr>
                        <tr>
                            <td>Effet favoris√© dans les <strong>milieux peu denses</strong></td>
                            <td><input type="text" class="input-field" id="comp_3" placeholder="Photo ou Compton ?"></td>
                        </tr>
                        <tr>
                            <td>Origine du <strong>rayonnement diffus√©</strong></td>
                            <td><input type="text" class="input-field" id="comp_4" placeholder="Patient, Tube ou D√©tecteur ?"></td>
                        </tr>
                    </table>
                    <div class="correction-inline" id="corr_comp">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong></p>
                        <p>1. <strong>Effet photo√©lectrique</strong> (pr√©pond√©rant basses tensions, milieux denses)</p>
                        <p>2. <strong>Effet Compton</strong> (pr√©pond√©rant hautes tensions, milieux peu denses)</p>
                        <p>3. <strong>Effet Compton</strong></p>
                        <p>4. <strong>Patient</strong> (le rayonnement diffus√© provient de la diffusion Compton dans le patient)</p>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion(13)">‚úì V√©rifier Q13</button>
                </div>
            </div>
        </div>

        <!-- TUBE √Ä RAYONS X -->
        <div id="tube" class="tab-content">
            <div class="section">
                <h2 class="section-title">III. Tube √† Rayons X - Sch√©ma Interactif</h2>
                
                <div class="question">
                    <span class="question-number">QUESTION 5 - Sch√©ma du tube RX</span>
                    <p class="question-text"><strong>Identifiez les 10 √©l√©ments du tube √† rayons X</strong></p>
                    <p style="margin: 10px 0; color: var(--warning);">üí° <strong>Instructions :</strong> Cliquez sur chaque num√©ro dans le sch√©ma pour activer le champ correspondant, puis remplissez votre r√©ponse.</p>
                    
                    <!-- Panneau Debug -->
                    <div class="debug-panel" id="debugPanel">
                        <div class="debug-info">üîß MODE DEBUG ACTIV√â</div>
                        <p style="margin-bottom: 10px;">Cliquez sur l'image pour positionner le point actif. Les coordonn√©es s'affichent ci-dessous.</p>
                        <div style="margin: 15px 0;">
                            <label style="color: var(--accent); font-weight: 600;">Point actif : </label>
                            <select id="activePoint" style="padding: 8px; background: var(--bg-input); color: var(--text); border: 1px solid var(--border); border-radius: 4px; font-family: 'JetBrains Mono', monospace;">
                                <option value="1">1 - Cathode</option>
                                <option value="2">2 - Filament</option>
                                <option value="3">3 - DDP</option>
                                <option value="4">4 - Filtre</option>
                                <option value="5">5 - Diaphragme</option>
                                <option value="6">6 - Rayons X</option>
                                <option value="7">7 - Refroidissement</option>
                                <option value="8">8 - Anode</option>
                                <option value="9">9 - Enceinte</option>
                                <option value="10">10 - Gaine plomb√©e</option>
                            </select>
                        </div>
                        <div class="debug-coords" id="debugCoords">
                            Cliquez sur l'image pour commencer...
                        </div>
                        <button class="btn btn-secondary btn-small" onclick="copyCoordinates()">üìã Copier les coordonn√©es</button>
                    </div>
                    
                    <div class="schema-container">
                        <div class="schema-wrapper" id="schemaWrapper">
                            <img src="tube_schema_vierge.png" alt="Sch√©ma du tube RX" class="schema-img" id="schemaImg">
                            <!-- Les points cliquables seront ajout√©s par JavaScript -->
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <div class="schema-input-group" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                <div>
                                    <label style="color: var(--accent); font-weight: 600;">1.</label>
                                    <input type="text" class="input-field" id="schema_1" placeholder="√âl√©ment 1">
                                    <div class="correction-inline" id="corr_schema_1">
                                        <div class="correction-label"></div>
                                        <p><strong>‚úì</strong> Cathode</p>
                                    </div>
                                </div>
                                <div>
                                    <label style="color: var(--accent); font-weight: 600;">2.</label>
                                    <input type="text" class="input-field" id="schema_2" placeholder="√âl√©ment 2">
                                    <div class="correction-inline" id="corr_schema_2">
                                        <div class="correction-label"></div>
                                        <p><strong>‚úì</strong> Filament</p>
                                    </div>
                                </div>
                                <div>
                                    <label style="color: var(--accent); font-weight: 600;">3.</label>
                                    <input type="text" class="input-field" id="schema_3" placeholder="√âl√©ment 3">
                                    <div class="correction-inline" id="corr_schema_3">
                                        <div class="correction-label"></div>
                                        <p><strong>‚úì</strong> DDP (Diff√©rence de Potentiel)</p>
                                    </div>
                                </div>
                                <div>
                                    <label style="color: var(--accent); font-weight: 600;">4.</label>
                                    <input type="text" class="input-field" id="schema_4" placeholder="√âl√©ment 4">
                                    <div class="correction-inline" id="corr_schema_4">
                                        <div class="correction-label"></div>
                                        <p><strong>‚úì</strong> Filtre</p>
                                    </div>
                                </div>
                                <div>
                                    <label style="color: var(--accent); font-weight: 600;">5.</label>
                                    <input type="text" class="input-field" id="schema_5" placeholder="√âl√©ment 5">
                                    <div class="correction-inline" id="corr_schema_5">
                                        <div class="correction-label"></div>
                                        <p><strong>‚úì</strong> Diaphragme</p>
                                    </div>
                                </div>
                                <div>
                                    <label style="color: var(--accent); font-weight: 600;">6.</label>
                                    <input type="text" class="input-field" id="schema_6" placeholder="√âl√©ment 6">
                                    <div class="correction-inline" id="corr_schema_6">
                                        <div class="correction-label"></div>
                                        <p><strong>‚úì</strong> Rayons X</p>
                                    </div>
                                </div>
                                <div>
                                    <label style="color: var(--accent); font-weight: 600;">7.</label>
                                    <input type="text" class="input-field" id="schema_7" placeholder="√âl√©ment 7">
                                    <div class="correction-inline" id="corr_schema_7">
                                        <div class="correction-label"></div>
                                        <p><strong>‚úì</strong> Syst√®me de refroidissement</p>
                                    </div>
                                </div>
                                <div>
                                    <label style="color: var(--accent); font-weight: 600;">8.</label>
                                    <input type="text" class="input-field" id="schema_8" placeholder="√âl√©ment 8">
                                    <div class="correction-inline" id="corr_schema_8">
                                        <div class="correction-label"></div>
                                        <p><strong>‚úì</strong> Anode</p>
                                    </div>
                                </div>
                                <div>
                                    <label style="color: var(--accent); font-weight: 600;">9.</label>
                                    <input type="text" class="input-field" id="schema_9" placeholder="√âl√©ment 9">
                                    <div class="correction-inline" id="corr_schema_9">
                                        <div class="correction-label"></div>
                                        <p><strong>‚úì</strong> Enceinte</p>
                                    </div>
                                </div>
                                <div>
                                    <label style="color: var(--accent); font-weight: 600;">10.</label>
                                    <input type="text" class="input-field" id="schema_10" placeholder="√âl√©ment 10">
                                    <div class="correction-inline" id="corr_schema_10">
                                        <div class="correction-label"></div>
                                        <p><strong>‚úì</strong> Gaine plomb√©e</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="btn-group" style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="checkQuestion(5)">‚úì V√©rifier le sch√©ma</button>
                        <button class="btn btn-secondary" onclick="resetSchema()">‚Üª Effacer</button>
                        <button class="btn btn-secondary" onclick="toggleDebugMode()" id="debugBtn" style="background: var(--warning); color: var(--bg); border-color: var(--warning);">üîß Mode Debug</button>
                    </div>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION 7</span>
                    <p class="question-text"><strong>Grand foyer vs Petit foyer</strong></p>
                    
                    <p><strong>1. Pour quels types d'examens utilise-t-on le GRAND foyer ?</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="grand_foyer" placeholder="Typologie des zones anatomiques..." rows="3"></textarea>
                        <div class="correction-inline" id="corr_grand_foyer">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong> Zones anatomiques <strong>√©paisses et p√©ristaltiques</strong> (poumons, digestif) - sans recherche de d√©finition fine. Permet des temps d'exposition plus courts et supporte des intensit√©s plus √©lev√©es.</p>
                        </div>
                    </div>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>2. Pour quels types d'examens utilise-t-on le PETIT foyer ?</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="petit_foyer" placeholder="Typologie des zones anatomiques..." rows="3"></textarea>
                        <div class="correction-inline" id="corr_petit_foyer">
                            <div class="correction-label"></div>
                            <p><strong>‚úì CORRECTION :</strong> Zones anatomiques <strong>peu √©paisses et statiques</strong> (os des membres, extr√©mit√©s) - recherche d'une <strong>bonne d√©finition</strong> (qualit√© fine) de l'image. Meilleure r√©solution spatiale mais n√©cessite des temps plus longs.</p>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion(7)">‚úì V√©rifier Q7</button>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION 8</span>
                    <p class="question-text"><strong>Foyer thermique et foyer optique</strong></p>
                    <table>
                        <tr>
                            <th>Caract√©ristique</th>
                            <th>Foyer Thermique</th>
                            <th>Foyer Optique</th>
                        </tr>
                        <tr>
                            <td>Autre nom</td>
                            <td><input type="text" class="input-field" id="ft_nom"></td>
                            <td><input type="text" class="input-field" id="fo_nom"></td>
                        </tr>
                        <tr>
                            <td>Correspondance</td>
                            <td><textarea class="input-field" id="ft_corr" rows="2"></textarea></td>
                            <td><textarea class="input-field" id="fo_corr" rows="2"></textarea></td>
                        </tr>
                        <tr>
                            <td>Impact principal</td>
                            <td><textarea class="input-field" id="ft_impact" rows="2"></textarea></td>
                            <td><textarea class="input-field" id="fo_impact" rows="2"></textarea></td>
                        </tr>
                    </table>
                    <div class="correction-inline" id="corr_foyers">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong></p>
                        <table style="margin-top: 10px;">
                            <tr>
                                <th></th>
                                <th>Foyer Thermique (R√©el)</th>
                                <th>Foyer Optique (Virtuel)</th>
                            </tr>
                            <tr>
                                <td><strong>Correspondance</strong></td>
                                <td>Point d'impact des √©lectrons sur le disque de l'anode</td>
                                <td>Projection g√©om√©trique du foyer thermique</td>
                            </tr>
                            <tr>
                                <td><strong>Dimensions</strong></td>
                                <td>D√©termin√©es par la taille du filament et l'angle de l'anode</td>
                                <td>Forme carr√©e visible depuis le patient</td>
                            </tr>
                            <tr>
                                <td><strong>Impact</strong></td>
                                <td>Gestion thermique de l'anode</td>
                                <td>D√©termine la r√©solution spatiale de l'image</td>
                            </tr>
                        </table>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion(8)">‚úì V√©rifier Q8</button>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION 9</span>
                    <p class="question-text"><strong>Le g√©n√©rateur - Compl√©tez le texte</strong></p>
                    
                    <p>Le g√©n√©rateur regroupe tous les <input type="text" class="input-field" id="gen_1" style="display: inline-block; width: 300px; margin: 0 5px;" placeholder="..."> qui alimentent le tube √† RX.</p>
                    
                    <p style="margin-top: 15px;"><strong>Son r√¥le :</strong></p>
                    <ul style="margin-left: 20px; line-height: 2.5;">
                        <li>Appliquer une <input type="text" class="input-field" id="gen_2" style="display: inline-block; width: 150px; margin: 0 5px;" placeholder="..."> (kV) au tube</li>
                        <li>Chauffer la <input type="text" class="input-field" id="gen_3" style="display: inline-block; width: 150px; margin: 0 5px;" placeholder="..."> pour obtenir l'<input type="text" class="input-field" id="gen_4" style="display: inline-block; width: 150px; margin: 0 5px;" placeholder="..."> (mA) d√©sir√©e</li>
                        <li>D√©terminer le <input type="text" class="input-field" id="gen_5" style="display: inline-block; width: 150px; margin: 0 5px;" placeholder="..."> de l'exposition</li>
                        <li>Assurer la <input type="text" class="input-field" id="gen_6" style="display: inline-block; width: 150px; margin: 0 5px;" placeholder="..."> du tube</li>
                    </ul>
                    <div class="correction-inline" id="corr_gen">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong></p>
                        <p>1. circuits √©lectroniques et √©lectriques<br>
                        2. tension U<br>
                        3. cathode<br>
                        4. intensit√© I<br>
                        5. temps (s)<br>
                        6. s√©curit√©</p>
                        <p style="margin-top: 10px;"><em>Le g√©n√©rateur est contenu dans une armoire √©lectrique et contr√¥l√© par un pupitre de commande.</em></p>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion(9)">‚úì V√©rifier Q9</button>
                </div>
            </div>
        </div>

        <!-- INDICATEURS DE DOSE -->
        <div id="doses" class="tab-content">
            <div class="section">
                <h2 class="section-title">IV. Indicateurs de Dose</h2>
                
                <div class="question">
                    <span class="question-number">QUESTION TD2-1</span>
                    <p class="question-text"><strong>PDS - Produit Dose Surface</strong></p>
                    <table>
                        <tr>
                            <th>Crit√®re</th>
                            <th>R√©ponse</th>
                        </tr>
                        <tr>
                            <td>Unit√©</td>
                            <td><input type="text" class="input-field" id="pds_unite"></td>
                        </tr>
                        <tr>
                            <td>Valeur transmise</td>
                            <td><input type="text" class="input-field" id="pds_valeur"></td>
                        </tr>
                        <tr>
                            <td>Document obligatoire</td>
                            <td><input type="text" class="input-field" id="pds_doc"></td>
                        </tr>
                        <tr>
                            <td>Proc√©d√© de recueil</td>
                            <td><input type="text" class="input-field" id="pds_recueil"></td>
                        </tr>
                        <tr>
                            <td>R√©f√©rence de comparaison</td>
                            <td><input type="text" class="input-field" id="pds_ref"></td>
                        </tr>
                        <tr>
                            <td>Int√©r√™t</td>
                            <td><input type="text" class="input-field" id="pds_interet"></td>
                        </tr>
                    </table>
                    <div class="correction-inline" id="corr_pds">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong></p>
                        <ul style="margin-left: 20px;">
                            <li><strong>Unit√© :</strong> mGy.cm¬≤</li>
                            <li><strong>Valeur transmise :</strong> Dose d√©livr√©e au patient</li>
                            <li><strong>Document :</strong> Compte rendu radiologique (obligatoire)</li>
                            <li><strong>Recueil :</strong> Chambre d'ionisation ou Calculateur int√©gr√©</li>
                            <li><strong>R√©f√©rence :</strong> Niveaux de R√©f√©rence Diagnostique (NRD)</li>
                            <li><strong>Int√©r√™t :</strong> √âvaluer ses pratiques et optimiser les doses</li>
                        </ul>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion('dose1')">‚úì V√©rifier</button>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION TD2-2</span>
                    <p class="question-text"><strong>Acronymes NRD, VGD, NRL</strong></p>
                    
                    <p><strong>1. Signification des acronymes :</strong></p>
                    <p style="margin: 10px 0;">NRD : <input type="text" class="input-field" id="nrd_def" placeholder="Signification compl√®te"></p>
                    <p style="margin: 10px 0;">VGD : <input type="text" class="input-field" id="vgd_def" placeholder="Signification compl√®te"></p>
                    <p style="margin: 10px 0;">NRL : <input type="text" class="input-field" id="nrl_def" placeholder="Signification compl√®te"></p>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>2. Finalit√© des NRD et VGD :</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="finalite_nrd" placeholder="√Ä quoi servent-ils ?" rows="2"></textarea>
                    </div>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>3. M√©thode statistique :</strong></p>
                    <p style="margin: 10px 0;">NRD : <input type="text" class="input-field" id="nrd_stat" placeholder="M√©thode"></p>
                    <p style="margin: 10px 0;">VGD : <input type="text" class="input-field" id="vgd_stat" placeholder="M√©thode"></p>
                    
                    <div class="correction-inline" id="corr_dose2">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong></p>
                        <p><strong>1. Acronymes :</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>NRD : <strong>Niveaux de R√©f√©rence Diagnostique</strong></li>
                            <li>VGD : <strong>Valeur Guide Diagnostique</strong></li>
                            <li>NRL : <strong>Niveaux de R√©f√©rence Local</strong></li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>2. Finalit√© :</strong> Outils dans la d√©marche d'optimisation des doses d√©livr√©es au patient.</p>
                        <p style="margin-top: 10px;"><strong>3. M√©thodes statistiques :</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>NRD : <strong>75√®me centile</strong> sur un groupe de patients types</li>
                            <li>VGD : <strong>M√©diane</strong> (50√®me centile)</li>
                        </ul>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion('dose2')">‚úì V√©rifier</button>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION TD2-3</span>
                    <p class="question-text"><strong>Optimisation des doses</strong></p>
                    
                    <p><strong>1. Compl√©tez :</strong> Le principe d'optimisation consiste √† trouver un <input type="text" class="input-field" id="optim_1" style="display: inline-block; width: 180px; margin: 0 5px;"> entre <input type="text" class="input-field" id="optim_2" style="display: inline-block; width: 180px; margin: 0 5px;"> et <input type="text" class="input-field" id="optim_3" style="display: inline-block; width: 180px; margin: 0 5px;"></p>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>2. Les 4 acteurs de l'optimisation :</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="acteurs" placeholder="Les 4 acteurs..." rows="3"></textarea>
                    </div>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>3. D√©marche selon les situations :</strong></p>
                    <p style="margin: 10px 0;">Si NRL > NRD : <textarea class="input-field" id="dem_1" rows="2"></textarea></p>
                    <p style="margin: 10px 0;">Si VGD < NRL < NRD : <textarea class="input-field" id="dem_2" rows="2"></textarea></p>
                    <p style="margin: 10px 0;">Si NRL < VGD de + de 20% : <textarea class="input-field" id="dem_3" rows="2"></textarea></p>
                    
                    <div class="correction-inline" id="corr_dose3">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong></p>
                        <p><strong>1.</strong> compromis / qualit√© image / dose</p>
                        <p style="margin-top: 10px;"><strong>2. Les 4 acteurs :</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>Physicien m√©dical</li>
                            <li>Radiologue</li>
                            <li>Manipulateur</li>
                            <li>Ing√©nieur d'application</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>3. D√©marches d'optimisation :</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>NRL > NRD : <strong>D√©marche d'optimisation PRIORITAIRE</strong> pour avoir des pratiques < aux NRD</li>
                            <li>VGD < NRL < NRD : <strong>D√©marche d'optimisation pour atteindre la VGD</strong></li>
                            <li>NRL < VGD de + 20% : <strong>√âvaluation de la qualit√© image</strong> (risque de sous-dosage)</li>
                        </ul>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion('dose3')">‚úì V√©rifier</button>
                </div>
            </div>
        </div>

        <!-- OST√âODENSITOM√âTRIE -->
        <div id="osteo" class="tab-content">
            <div class="section">
                <h2 class="section-title">V. Ost√©odensitom√©trie</h2>
                
                <div class="question">
                    <span class="question-number">QUESTION TD2-4</span>
                    <p class="question-text"><strong>Tableau complet ost√©odensitom√©trie</strong></p>
                    <table>
                        <tr>
                            <th style="width: 40%;">Crit√®re</th>
                            <th>R√©ponse</th>
                        </tr>
                        <tr>
                            <td>D√©finition</td>
                            <td><textarea class="input-field" id="osteo_def" rows="2"></textarea></td>
                        </tr>
                        <tr>
                            <td>Signification DMO + unit√©</td>
                            <td><input type="text" class="input-field" id="osteo_dmo"></td>
                        </tr>
                        <tr>
                            <td>Principe physique (loi)</td>
                            <td><textarea class="input-field" id="osteo_loi" rows="2"></textarea></td>
                        </tr>
                        <tr>
                            <td>Technologie radiologique</td>
                            <td><textarea class="input-field" id="osteo_tech" rows="3"></textarea></td>
                        </tr>
                        <tr>
                            <td>√ânergies utilis√©es</td>
                            <td><input type="text" class="input-field" id="osteo_energie"></td>
                        </tr>
                        <tr>
                            <td>Obtention des √©nergies</td>
                            <td><textarea class="input-field" id="osteo_obtention" rows="2"></textarea></td>
                        </tr>
                        <tr>
                            <td>3 g√©om√©tries possibles</td>
                            <td><textarea class="input-field" id="osteo_geom" rows="2"></textarea></td>
                        </tr>
                        <tr>
                            <td>2 types de d√©tecteur</td>
                            <td><textarea class="input-field" id="osteo_detect" rows="3"></textarea></td>
                        </tr>
                    </table>
                    <div class="correction-inline" id="corr_osteo">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong></p>
                        <ul style="margin-left: 20px;">
                            <li><strong>D√©finition :</strong> Examen m√©dical mesurant la densit√© osseuse (DMO)</li>
                            <li><strong>DMO :</strong> Densit√© Min√©rale Osseuse, en <strong>gramme/cm¬≤</strong></li>
                            <li><strong>Principe :</strong> Loi d'absorption - mesure de l'att√©nuation d'un faisceau de photons par la mati√®re</li>
                            <li><strong>Technologie :</strong> Absorption biphotonique - √âmission de photons X √† 2 √©nergies diff√©rentes vers un site osseux (rachis, f√©mur, radius) ‚Üí mesure absorption diff√©rentielle</li>
                            <li><strong>√ânergies :</strong> 70/140 kV ou 100/140 kV</li>
                            <li><strong>Obtention :</strong> Variation de tension du tube OU tension constante + filtration terre rare</li>
                            <li><strong>3 g√©om√©tries :</strong> Faisceau droit / Faisceau en √©ventail √©troit / Faisceau en √©ventail large</li>
                            <li><strong>2 d√©tecteurs :</strong> Conversion indirecte (RX‚Üílumi√®re‚Üísignal) : scintillateur+photodiode / Conversion directe (RX‚Üísignal) : semi-conducteur</li>
                        </ul>
                        <div class="hors-td" style="margin-top: 10px;">
                            L'ost√©odensitom√©trie est indiqu√©e pour le diagnostic de l'ost√©oporose. R√©sultat en <strong>T-score</strong> (comparaison avec adulte jeune) : normal > -1, ost√©op√©nie entre -1 et -2,5, ost√©oporose < -2,5. Irradiation tr√®s faible (‚âà 1 ¬µSv).
                        </div>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion('osteo')">‚úì V√©rifier</button>
                </div>
            </div>
        </div>

        <!-- ANALYSE SPECTRALE -->
        <div id="spectrale" class="tab-content">
            <div class="section">
                <h2 class="section-title">VI. Analyse Spectrale</h2>
                
                <div class="question">
                    <span class="question-number">QUESTION TD2-5</span>
                    <p class="question-text"><strong>Signal p√©riodique : T = 4 ms</strong></p>
                    
                    <p><strong>1. P√©riode en diff√©rentes unit√©s :</strong></p>
                    <p style="margin: 10px 0;">En ms : <input type="text" class="input-field" id="spec_ms" style="display: inline-block; width: 120px; margin: 0 5px;"></p>
                    <p style="margin: 10px 0;">En secondes (notation scientifique) : <input type="text" class="input-field" id="spec_s" style="display: inline-block; width: 200px; margin: 0 5px;"></p>
                    
                    <p class="question-text" style="margin-top: 20px;"><strong>2. Calculez la fr√©quence (avec le calcul) :</strong></p>
                    <div class="input-group">
                        <textarea class="input-field" id="spec_freq" placeholder="Formule + calcul + r√©sultat..." rows="3"></textarea>
                    </div>
                    
                    <div class="correction-inline" id="corr_spec">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong></p>
                        <p><strong>1. P√©riode :</strong> 4 ms ou 4.10‚Åª¬≥ s ou 0,004 s</p>
                        <p style="margin-top: 10px;"><strong>2. Fr√©quence :</strong></p>
                        <p style="margin-left: 20px;">Formule : f = 1 / T<br>
                        Calcul : f = 1 / 4.10‚Åª¬≥<br>
                        <strong>R√©sultat : f = 250 Hz</strong></p>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion('spec')">‚úì V√©rifier</button>
                </div>

                <div class="question">
                    <span class="question-number">QUESTION TD2-6</span>
                    <p class="question-text"><strong>Vrai/Faux - Spectre de Fourier</strong></p>
                    
                    <p style="margin: 15px 0;"><strong>a) Le 1er pic (f‚ÇÄ) se nomme le FONDAMENTAL et les autres (f‚ÇÅ, f‚ÇÇ...) les HARMONIQUES</strong></p>
                    <div class="option-group">
                        <label class="option">
                            <input type="radio" name="vf_1" value="vrai">
                            VRAI
                        </label>
                        <label class="option">
                            <input type="radio" name="vf_1" value="faux">
                            FAUX
                        </label>
                    </div>
                    <textarea class="input-field" id="vf_1_just" placeholder="Justification si FAUX" rows="2"></textarea>
                    
                    <p style="margin: 15px 0;"><strong>b) Le spectre de Fourier repr√©sente aussi bien les signaux p√©riodiques que non p√©riodiques</strong></p>
                    <div class="option-group">
                        <label class="option">
                            <input type="radio" name="vf_2" value="vrai">
                            VRAI
                        </label>
                        <label class="option">
                            <input type="radio" name="vf_2" value="faux">
                            FAUX
                        </label>
                    </div>
                    <textarea class="input-field" id="vf_2_just" placeholder="Justification si FAUX" rows="2"></textarea>
                    
                    <p style="margin: 15px 0;"><strong>c) Seul le signal sinuso√Ødal est simple, les autres sont une somme de sinuso√Ødes</strong></p>
                    <div class="option-group">
                        <label class="option">
                            <input type="radio" name="vf_3" value="vrai">
                            VRAI
                        </label>
                        <label class="option">
                            <input type="radio" name="vf_3" value="faux">
                            FAUX
                        </label>
                    </div>
                    <textarea class="input-field" id="vf_3_just" placeholder="Justification si FAUX" rows="2"></textarea>
                    
                    <p style="margin: 15px 0;"><strong>d) Le spectre du signal CR√âNEAU poss√®de 1 seul pic</strong></p>
                    <div class="option-group">
                        <label class="option">
                            <input type="radio" name="vf_4" value="vrai">
                            VRAI
                        </label>
                        <label class="option">
                            <input type="radio" name="vf_4" value="faux">
                            FAUX
                        </label>
                    </div>
                    <textarea class="input-field" id="vf_4_just" placeholder="Justification si FAUX" rows="2"></textarea>
                    
                    <div class="correction-inline" id="corr_vf">
                        <div class="correction-label"></div>
                        <p><strong>‚úì CORRECTION :</strong></p>
                        <p><strong>a) VRAI</strong> - Le fondamental (f‚ÇÄ) est la fr√©quence de base, les harmoniques sont multiples entiers (f‚ÇÅ=2f‚ÇÄ, f‚ÇÇ=3f‚ÇÄ...)</p>
                        <p style="margin-top: 8px;"><strong>b) FAUX</strong> - Uniquement pour signaux p√©riodiques. Les non p√©riodiques n√©cessitent la transform√©e de Fourier g√©n√©ralis√©e.</p>
                        <p style="margin-top: 8px;"><strong>c) VRAI</strong> - Le sinus pur ne contient qu'une fr√©quence. Tous les autres signaux p√©riodiques = somme de sinuso√Ødes (th√©or√®me de Fourier).</p>
                        <p style="margin-top: 8px;"><strong>d) FAUX</strong> - Le signal cr√©neau est une somme de 4 sinuso√Ødes (ou plus) de fr√©quences diff√©rentes (fondamental + harmoniques impaires).</p>
                        <div class="hors-td" style="margin-top: 10px;">
                            En √©chographie, l'analyse spectrale permet d'analyser les fr√©quences du signal Doppler pour mesurer les vitesses sanguines.
                        </div>
                    </div>
                    
                    <button class="btn btn-primary btn-small" onclick="checkQuestion('vf')">‚úì V√©rifier</button>
                </div>
            </div>
        </div>

        <div class="btn-group" style="margin-top: 30px;">
            <button class="btn btn-primary" onclick="checkAll()">‚úì V√âRIFIER TOUT</button>
            <button class="btn btn-secondary" onclick="showAllCorrections()">üëÅÔ∏è AFFICHER TOUTES LES CORRECTIONS</button>
            <button class="btn btn-secondary" onclick="resetAll()">‚Üª TOUT EFFACER</button>
        </div>

        <div class="score-display" id="scoreDisplay">
            <h2 style="color: var(--accent); font-family: 'JetBrains Mono', monospace;">R√âSULTAT GLOBAL</h2>
            <div class="score-number" id="scoreNumber">0/100+</div>
            <p id="scoreMessage" style="color: var(--text-muted); margin-top: 20px;"></p>
        </div>
    </div>

    <script>
        let currentTab = 'production';
        let debugMode = false;
        let pointPositions = {
            1: { x: 36.8, y: 50 },      // Cathode
            2: { x: 46.7, y: 61.9 },    // Filament
            3: { x: 54.1, y: 43.8 },    // DDP
            4: { x: 54.8, y: 69.1 },    // Filtre
            5: { x: 46, y: 80.3 },      // Diaphragme
            6: { x: 58.7, y: 92.8 },    // Rayons X
            7: { x: 68.5, y: 64.4 },    // Refroidissement
            8: { x: 73.4, y: 49.6 },    // Anode
            9: { x: 60.8, y: 30.4 },    // Enceinte
            10: { x: 30.4, y: 60.3 }    // Gaine plomb√©e
        };

        function normalize(text) {
            if (!text) return '';
            return text.toLowerCase()
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '')
                .replace(/[^a-z0-9]/g, '');
        }

        function containsKeywords(userAnswer, keywords) {
            const normalized = normalize(userAnswer);
            return keywords.some(keyword => normalized.includes(normalize(keyword)));
        }

        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const btns = document.querySelectorAll('.tab-btn');
            
            tabs.forEach(t => t.classList.remove('active'));
            btns.forEach(b => b.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            currentTab = tabName;
            updateProgress();
        }

        function updateProgress() {
            let answered = 0;
            let total = 0;
            
            document.querySelectorAll('.input-field').forEach(field => {
                if (field.type !== 'radio') {
                    total++;
                    if (field.value && field.value.trim()) answered++;
                }
            });
            
            const percent = total > 0 ? (answered / total) * 100 : 0;
            document.getElementById('progressBar').style.width = percent + '%';
        }

        // Syst√®me de v√©rification g√©n√©rique
        function checkField(fieldId, keywords, corrId) {
            const field = document.getElementById(fieldId);
            const corr = document.getElementById(corrId);
            
            if (!field || !corr) return false;
            
            const isCorrect = containsKeywords(field.value, keywords);
            
            field.classList.remove('ok', 'ko');
            corr.classList.remove('ok', 'ko');
            
            if (isCorrect) {
                field.classList.add('ok');
                corr.classList.add('ok');
                corr.querySelector('.correction-label').textContent = '‚úì CORRECT';
            } else {
                field.classList.add('ko');
                corr.classList.add('ko');
                corr.querySelector('.correction-label').textContent = '‚úó √Ä REVOIR';
            }
            
            corr.classList.add('show');
            return isCorrect;
        }

        // Questions sp√©cifiques
        function checkQuestion(num) {
            let correct = 0;
            let total = 0;
            
            if (num === 1) {
                total = 3;
                if (checkField('def_rx', ['onde', 'electromagnetique', 'frequence', 'nanometre', 'ionisant'], 'corr_def_rx')) correct++;
                if (checkField('def_ionisant', ['ionisant', 'energie', 'ion', 'atome', 'instable'], 'corr_def_ionisant')) correct++;
                if (checkField('diff_gamma', ['production', 'nuage', 'electronique', 'noyau'], 'corr_diff_gamma')) correct++;
            }
            else if (num === 2) {
                total = 4;
                if (checkField('prod_1', ['electron'], 'corr_prod_phrase')) correct++;
                if (checkField('prod_2', ['cible', 'metallique', 'dense'], 'corr_prod_phrase')) correct++;
                if (checkField('modes_prod', ['freinage', 'noyau', 'rearrangement', 'electron'], 'corr_modes_prod')) correct++;
                if (checkField('majoritaire', ['freinage', 'noyau'], 'corr_majoritaire')) correct++;
            }
            else if (num === 3) {
                total = 2;
                if (checkField('rearra_expl', ['energie', 'expulsion', 'rearrangement', 'cascade', 'emission'], 'corr_rearra_expl')) correct++;
                const spectre = document.querySelector('input[name="spectre_type"]:checked');
                if (spectre && spectre.value === 'raies') {
                    spectre.parentElement.classList.add('ok');
                    correct++;
                } else if (spectre) {
                    spectre.parentElement.classList.add('ko');
                }
                document.getElementById('corr_spectre_type').classList.add('show');
            }
            else if (num === 4) {
                total = 2;
                if (checkField('freinage_expl', ['electron', 'noyau', 'attire', 'deviation', 'energie', 'freinage'], 'corr_freinage_expl')) correct++;
                const spectre = document.querySelector('input[name="spectre_freinage"]:checked');
                if (spectre && spectre.value === 'continu') {
                    spectre.parentElement.classList.add('ok');
                    correct++;
                } else if (spectre) {
                    spectre.parentElement.classList.add('ko');
                }
                document.getElementById('corr_spectre_freinage').classList.add('show');
            }
            else if (num === 5) {
                // Sch√©ma du tube
                const schema_answers = {
                    'schema_1': 'cathode',
                    'schema_2': 'filament',
                    'schema_3': 'ddp',
                    'schema_4': 'filtre',
                    'schema_5': 'diaphragme',
                    'schema_6': 'rayons',
                    'schema_7': 'refroidissement',
                    'schema_8': 'anode',
                    'schema_9': 'enceinte',
                    'schema_10': 'gaine'
                };
                
                total = 10;
                for (let [id, answer] of Object.entries(schema_answers)) {
                    if (checkField(id, [answer], 'corr_' + id)) correct++;
                }
            }
            else if (num === 7) {
                total = 2;
                if (checkField('grand_foyer', ['epais', 'peristaltique', 'poumon', 'digestif'], 'corr_grand_foyer')) correct++;
                if (checkField('petit_foyer', ['peu epais', 'statique', 'os', 'membre', 'definition'], 'corr_petit_foyer')) correct++;
            }
            else if (num === 8) {
                total = 6;
                if (checkField('ft_nom', ['reel'], 'corr_foyers')) correct++;
                if (checkField('fo_nom', ['virtuel'], 'corr_foyers')) correct++;
                if (checkField('ft_corr', ['impact', 'electron', 'anode'], 'corr_foyers')) correct++;
                if (checkField('fo_corr', ['projection', 'geometrique'], 'corr_foyers')) correct++;
                if (checkField('ft_impact', ['thermique', 'chaleur'], 'corr_foyers')) correct++;
                if (checkField('fo_impact', ['resolution', 'definition', 'spatiale'], 'corr_foyers')) correct++;
            }
            else if (num === 9) {
                total = 6;
                const fields = ['gen_1', 'gen_2', 'gen_3', 'gen_4', 'gen_5', 'gen_6'];
                const answers = ['circuit', 'tension', 'cathode', 'intensite', 'temps', 'securite'];
                fields.forEach((id, i) => {
                    if (checkField(id, [answers[i]], 'corr_gen')) correct++;
                });
            }
            else if (num === 10) {
                total = 2;
                if (checkField('img_radiante', ['attenuation', 'difference', 'milieu', 'gris'], 'corr_img_radiante')) correct++;
                if (checkField('facteurs_att', ['epaisseur', 'composition', 'densite', 'energie'], 'corr_facteurs_att')) correct++;
            }
            else if (num === 11) {
                if (checkField('photo_expl', ['photon', 'cede', 'toute', 'energie', 'electron', 'fluorescence'], 'corr_photo_expl')) correct = 1;
                total = 1;
            }
            else if (num === 12) {
                if (checkField('compton_expl', ['photon', 'electron', 'partie', 'energie', 'diffuse'], 'corr_compton_expl')) correct = 1;
                total = 1;
            }
            else if (num === 13) {
                total = 4;
                if (checkField('comp_1', ['photoelectrique', 'photo'], 'corr_comp')) correct++;
                if (checkField('comp_2', ['compton'], 'corr_comp')) correct++;
                if (checkField('comp_3', ['compton'], 'corr_comp')) correct++;
                if (checkField('comp_4', ['patient'], 'corr_comp')) correct++;
            }
            else if (num === 'dose1') {
                total = 6;
                if (checkField('pds_unite', ['mgy', 'cm2'], 'corr_pds')) correct++;
                if (checkField('pds_valeur', ['dose', 'patient'], 'corr_pds')) correct++;
                if (checkField('pds_doc', ['compte', 'rendu'], 'corr_pds')) correct++;
                if (checkField('pds_recueil', ['chambre', 'ionisation', 'calculateur'], 'corr_pds')) correct++;
                if (checkField('pds_ref', ['nrd', 'reference'], 'corr_pds')) correct++;
                if (checkField('pds_interet', ['evaluer', 'pratique', 'optimiser'], 'corr_pds')) correct++;
            }
            else if (num === 'dose2') {
                total = 6;
                if (checkField('nrd_def', ['niveau', 'reference', 'diagnostique'], 'corr_dose2')) correct++;
                if (checkField('vgd_def', ['valeur', 'guide', 'diagnostique'], 'corr_dose2')) correct++;
                if (checkField('nrl_def', ['niveau', 'reference', 'local'], 'corr_dose2')) correct++;
                if (checkField('finalite_nrd', ['optimisation', 'dose'], 'corr_dose2')) correct++;
                if (checkField('nrd_stat', ['75', 'centile'], 'corr_dose2')) correct++;
                if (checkField('vgd_stat', ['mediane', '50'], 'corr_dose2')) correct++;
            }
            else if (num === 'dose3') {
                total = 7;
                if (checkField('optim_1', ['compromis'], 'corr_dose3')) correct++;
                if (checkField('optim_2', ['qualite', 'image'], 'corr_dose3')) correct++;
                if (checkField('optim_3', ['dose'], 'corr_dose3')) correct++;
                if (checkField('acteurs', ['physicien', 'radiologue', 'manipulateur', 'ingenieur'], 'corr_dose3')) correct++;
                if (checkField('dem_1', ['prioritaire', 'optimisation'], 'corr_dose3')) correct++;
                if (checkField('dem_2', ['optimisation', 'vgd'], 'corr_dose3')) correct++;
                if (checkField('dem_3', ['qualite', 'image'], 'corr_dose3')) correct++;
            }
            else if (num === 'osteo') {
                total = 8;
                if (checkField('osteo_def', ['examen', 'densite', 'osseuse', 'dmo'], 'corr_osteo')) correct++;
                if (checkField('osteo_dmo', ['densite', 'minerale', 'osseuse', 'gramme'], 'corr_osteo')) correct++;
                if (checkField('osteo_loi', ['absorption', 'attenuation', 'photon'], 'corr_osteo')) correct++;
                if (checkField('osteo_tech', ['biphotonique', '2 energie', 'rachis', 'femur'], 'corr_osteo')) correct++;
                if (checkField('osteo_energie', ['70', '140', '100'], 'corr_osteo')) correct++;
                if (checkField('osteo_obtention', ['variation', 'tension', 'filtration'], 'corr_osteo')) correct++;
                if (checkField('osteo_geom', ['droit', 'eventail'], 'corr_osteo')) correct++;
                if (checkField('osteo_detect', ['conversion', 'indirecte', 'directe'], 'corr_osteo')) correct++;
            }
            else if (num === 'spec') {
                total = 3;
                if (checkField('spec_ms', ['4'], 'corr_spec')) correct++;
                if (checkField('spec_s', ['4', '10', '3', '0.004', '0,004'], 'corr_spec')) correct++;
                if (checkField('spec_freq', ['250', 'hz'], 'corr_spec')) correct++;
            }
            else if (num === 'vf') {
                total = 4;
                const answers = [['vf_1', 'vrai'], ['vf_2', 'faux'], ['vf_3', 'vrai'], ['vf_4', 'faux']];
                answers.forEach(([name, correctValue]) => {
                    const selected = document.querySelector(`input[name="${name}"]:checked`);
                    if (selected && selected.value === correctValue) {
                        selected.parentElement.classList.add('ok');
                        correct++;
                    } else if (selected) {
                        selected.parentElement.classList.add('ko');
                    }
                });
                document.getElementById('corr_vf').classList.add('show');
            }
            
            if (total > 0) {
                const percent = (correct / total) * 100;
                const message = percent === 100 ? 'üéâ Parfait !' : 
                               percent >= 70 ? 'üëç Bien !' : 
                               percent >= 50 ? '‚ö†Ô∏è √Ä am√©liorer' : '‚ùå √Ä revoir';
                console.log(`Question ${num}: ${correct}/${total} (${percent.toFixed(0)}%) - ${message}`);
            }
        }

        function checkAll() {
            const questions = [1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 'dose1', 'dose2', 'dose3', 'osteo', 'spec', 'vf'];
            questions.forEach(q => checkQuestion(q));
            
            let totalCorrect = document.querySelectorAll('.input-field.ok, .option.ok').length;
            document.getElementById('scoreDisplay').classList.add('show');
            document.getElementById('scoreNumber').textContent = `${totalCorrect}/100+`;
            
            const percent = totalCorrect / 100 * 100;
            let message = '';
            if (percent >= 90) message = 'üèÜ EXCELLENT - Ma√Ætrise parfaite';
            else if (percent >= 75) message = '‚≠ê TR√àS BIEN - Solides connaissances';
            else if (percent >= 60) message = '‚úì BIEN - Bases acquises';
            else message = '‚ö†Ô∏è √Ä approfondir - Relisez les corrections';
            
            document.getElementById('scoreMessage').textContent = message;
            document.getElementById('scoreDisplay').scrollIntoView({ behavior: 'smooth' });
        }

        function showAllCorrections() {
            document.querySelectorAll('.correction-inline').forEach(corr => {
                corr.classList.add('show');
            });
        }

        function resetAll() {
            if (confirm('√ätes-vous s√ªr de vouloir tout effacer ?')) {
                document.querySelectorAll('.input-field').forEach(field => {
                    field.value = '';
                    field.classList.remove('ok', 'ko');
                });
                document.querySelectorAll('input[type="radio"]').forEach(r => {
                    r.checked = false;
                    r.parentElement.classList.remove('ok', 'ko');
                });
                document.querySelectorAll('.correction-inline').forEach(corr => {
                    corr.classList.remove('show', 'ok', 'ko');
                });
                document.getElementById('scoreDisplay').classList.remove('show');
                updateProgress();
            }
        }

        function resetSchema() {
            for (let i = 1; i <= 10; i++) {
                const field = document.getElementById(`schema_${i}`);
                const corr = document.getElementById(`corr_schema_${i}`);
                if (field) {
                    field.value = '';
                    field.classList.remove('ok', 'ko');
                }
                if (corr) {
                    corr.classList.remove('show', 'ok', 'ko');
                }
            }
        }

        // Mode Debug
        function toggleDebugMode() {
            debugMode = !debugMode;
            const panel = document.getElementById('debugPanel');
            const wrapper = document.getElementById('schemaWrapper');
            const btn = document.getElementById('debugBtn');
            
            if (debugMode) {
                panel.classList.add('active');
                wrapper.classList.add('debug-mode');
                btn.textContent = 'üîß D√©sactiver Debug';
                btn.style.background = 'var(--error)';
                updateDebugDisplay();
                setupDebugListeners();
            } else {
                panel.classList.remove('active');
                wrapper.classList.remove('debug-mode');
                btn.textContent = 'üîß Mode Debug';
                btn.style.background = 'var(--warning)';
                removeDebugListeners();
            }
        }

        function setupDebugListeners() {
            const wrapper = document.getElementById('schemaWrapper');
            const img = document.getElementById('schemaImg');
            
            if (!wrapper || !img) return;
            
            wrapper.addEventListener('click', handleDebugClick);
            
            // Mettre en √©vidence le point actif
            document.getElementById('activePoint').addEventListener('change', updateActivePoint);
            updateActivePoint();
        }

        function removeDebugListeners() {
            const wrapper = document.getElementById('schemaWrapper');
            if (wrapper) {
                wrapper.removeEventListener('click', handleDebugClick);
            }
        }

        function handleDebugClick(e) {
            if (!debugMode) return;
            
            const wrapper = document.getElementById('schemaWrapper');
            const img = document.getElementById('schemaImg');
            const rect = img.getBoundingClientRect();
            
            // Calculer la position relative au conteneur
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Convertir en pourcentage
            const xPercent = (x / rect.width * 100).toFixed(1);
            const yPercent = (y / rect.height * 100).toFixed(1);
            
            // Mettre √† jour la position du point actif
            const activeNum = parseInt(document.getElementById('activePoint').value);
            pointPositions[activeNum] = { x: parseFloat(xPercent), y: parseFloat(yPercent) };
            
            // Mettre √† jour l'affichage
            updatePointPosition(activeNum);
            updateDebugDisplay();
            
            // Ajouter un indicateur de clic
            const indicator = document.createElement('div');
            indicator.className = 'click-indicator';
            indicator.style.left = `${xPercent}%`;
            indicator.style.top = `${yPercent}%`;
            wrapper.appendChild(indicator);
            setTimeout(() => indicator.remove(), 1000);
        }

        function updatePointPosition(num) {
            const wrapper = document.getElementById('schemaWrapper');
            const point = Array.from(wrapper.querySelectorAll('.schema-point')).find(p => p.textContent == num);
            
            if (point) {
                point.style.left = `${pointPositions[num].x}%`;
                point.style.top = `${pointPositions[num].y}%`;
            }
        }

        function updateActivePoint() {
            const wrapper = document.getElementById('schemaWrapper');
            const activeNum = parseInt(document.getElementById('activePoint').value);
            
            // Retirer la classe active de tous les points
            wrapper.querySelectorAll('.schema-point').forEach(p => {
                p.classList.remove('debug-active');
            });
            
            // Ajouter la classe au point actif
            const activePoint = Array.from(wrapper.querySelectorAll('.schema-point')).find(p => p.textContent == activeNum);
            if (activePoint) {
                activePoint.classList.add('debug-active');
            }
        }

        function updateDebugDisplay() {
            const coords = document.getElementById('debugCoords');
            const labels = {
                1: 'Cathode',
                2: 'Filament',
                3: 'DDP',
                4: 'Filtre',
                5: 'Diaphragme',
                6: 'Rayons X',
                7: 'Refroidissement',
                8: 'Anode',
                9: 'Enceinte',
                10: 'Gaine plomb√©e'
            };
            
            let html = '<div style="margin-bottom: 15px; color: var(--accent); font-weight: 600;">üìç Coordonn√©es actuelles :</div>';
            
            for (let i = 1; i <= 10; i++) {
                const pos = pointPositions[i];
                html += `<div class="coord-line">
                    <strong>${i}.</strong> ${labels[i]} ‚Üí 
                    <span style="color: var(--accent);">x: ${pos.x}%, y: ${pos.y}%</span>
                </div>`;
            }
            
            coords.innerHTML = html;
        }

        function copyCoordinates() {
            let code = 'const points = [\n';
            const labels = {
                1: 'Cathode',
                2: 'Filament',
                3: 'DDP',
                4: 'Filtre',
                5: 'Diaphragme',
                6: 'Rayons X',
                7: 'Refroidissement',
                8: 'Anode',
                9: 'Enceinte',
                10: 'Gaine plomb√©e'
            };
            
            for (let i = 1; i <= 10; i++) {
                const pos = pointPositions[i];
                code += `    { num: ${i}, x: ${pos.x}, y: ${pos.y} },    // ${labels[i]}\n`;
            }
            code += '];';
            
            navigator.clipboard.writeText(code).then(() => {
                alert('‚úÖ Coordonn√©es copi√©es dans le presse-papier !');
            }).catch(() => {
                // Fallback si clipboard API ne marche pas
                const textarea = document.createElement('textarea');
                textarea.value = code;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('‚úÖ Coordonn√©es copi√©es !');
            });
        }

        // Initialisation du sch√©ma interactif
        function initSchema() {
            const wrapper = document.getElementById('schemaWrapper');
            const img = document.getElementById('schemaImg');
            
            if (!wrapper || !img) return;
            
            const labels = {
                1: 'Cathode',
                2: 'Filament',
                3: 'DDP',
                4: 'Filtre',
                5: 'Diaphragme',
                6: 'Rayons X',
                7: 'Refroidissement',
                8: 'Anode',
                9: 'Enceinte',
                10: 'Gaine plomb√©e'
            };
            
            for (let i = 1; i <= 10; i++) {
                const dot = document.createElement('div');
                dot.className = 'schema-point';
                dot.textContent = i;
                dot.style.left = `${pointPositions[i].x}%`;
                dot.style.top = `${pointPositions[i].y}%`;
                dot.title = labels[i];
                
                dot.addEventListener('click', (e) => {
                    if (debugMode) {
                        e.stopPropagation();
                        document.getElementById('activePoint').value = i;
                        updateActivePoint();
                    } else {
                        const field = document.getElementById(`schema_${i}`);
                        if (field) {
                            field.focus();
                            field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    }
                });
                
                wrapper.appendChild(dot);
            }
            
            // Marquer les points r√©pondus
            for (let i = 1; i <= 10; i++) {
                const field = document.getElementById(`schema_${i}`);
                if (field) {
                    field.addEventListener('input', function() {
                        const dot = Array.from(wrapper.querySelectorAll('.schema-point')).find(d => d.textContent == i);
                        if (this.value.trim() && dot) {
                            dot.classList.add('answered');
                        } else if (dot) {
                            dot.classList.remove('answered');
                        }
                    });
                }
            }
        }

        document.addEventListener('input', updateProgress);
        document.addEventListener('change', updateProgress);
        
        // Initialiser au chargement
        window.addEventListener('load', () => {
            initSchema();
            updateProgress();
        });
    </script>
</body>
</html>
