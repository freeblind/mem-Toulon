<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Le Criblage : 14 Besoins de V. Henderson</title>
<style>
    /* Les styles sont √©pur√©s, inspir√©s de ton mod√®le, mais sans l'exc√®s.
       Seul l'essentiel pour la survie du QCM reste. */
    :root{--bg:#0f172a;--card:#111827;--muted:#94a3b8;--text:#e5e7eb;--ok:#16a34a;--ko:#dc2626;--accent:#2563eb;--ink:#0b1223;--light:#e5e7eb}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,#0b1223,#0f172a);color:var(--text);font:16px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    .container{max-width:800px;margin:0 auto;padding:24px}
    header{margin-bottom:24px}
    h1{font-size:clamp(1.2rem,3vw,1.9rem);margin:0;color:var(--text);border-bottom:2px solid rgba(148,163,184,.3);padding-bottom:10px}
    .card{background:rgba(17,24,39,.9);backdrop-filter:saturate(1.2) blur(6px);border:1px solid rgba(148,163,184,.18);border-radius:16px;padding:20px;margin:20px 0;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    .btn{cursor:pointer;border:1px solid rgba(148,163,184,.48);background:#0b1223;color:var(--text);padding:10px 18px;border-radius:999px;font-weight:700;transition:transform .05s ease, background .2s, filter .2s; font-size:1rem; text-transform:uppercase}
    .btn:hover{background:#0f1a31;border-color:var(--accent)}
    .btn:active{transform:translateY(1px)}
    .btn.primary{background:var(--accent);border-color:transparent}
    .btn.primary:hover{filter:brightness(1.1)}

    /* Style sp√©cifique pour les "besoins" cliquables */
    .need-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-top:20px}
    .need-item{text-align:center;padding:15px 10px;border:2px solid rgba(148,163,184,.4);border-radius:8px;cursor:pointer;font-weight:600;transition:all .15s ease}
    .need-item:hover{background:rgba(37,99,235,.2);border-color:var(--accent)}
    .need-item.selected{background:rgba(37,99,235,.5);border-color:var(--accent);transform:scale(1.05)}
    .need-item.correct{background:var(--ok);border-color:var(--ok);color:var(--ink);pointer-events:none}
    .need-item.incorrect{background:var(--ko);border-color:var(--ko);color:var(--light);pointer-events:none;text-decoration:line-through}

    /* Bo√Æte de message pour les erreurs/instructions */
    #message-box{min-height:40px;padding:10px 15px;border-radius:8px;margin-top:20px;font-weight:700;line-height:1.4}
    .msg-error{background:rgba(220,38,38,.2);border:1px solid var(--ko);color:var(--ko)}
    .msg-info{background:rgba(37,99,235,.2);border:1px solid var(--accent);color:var(--accent)}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Le Criblage : Les 14 Besoins Fondamentaux (Virginia Henderson)</h1>
      <p class="muted">Trie le grain de l'ivraie. Clique uniquement sur les **vrais** besoins de Henderson.</p>
    </header>

    <div class="card">
      <div id="need-container" class="need-grid">
        </div>

      <div id="message-box" class="msg-info">S√©lectionne tous les vrais besoins puis clique sur "Poursuivre" pour valider ou "Rafra√Æchir" si rien n'est bon.</div>

      <div style="display:flex;justify-content:space-between;margin-top:20px">
        <button id="refresh-btn" class="btn">üîÑ Rafra√Æchir</button>
        <button id="check-btn" class="btn primary">üî• Poursuivre</button>
      </div>
    </div>

    <footer class="muted" style="font-size:.85rem;text-align:center;margin-top:40px">
        La survie se m√©rite.
    </footer>
  </div>

  <script>
// Les 14 Vrais Besoins Fondamentaux selon Virginia Henderson
const VRAIS_BESOINS = [
    "Respirer",
    "Boire et manger",
    "√âliminer",
    "Se mouvoir et maintenir une bonne posture",
    "Dormir et se reposer",
    "Se v√™tir et se d√©v√™tir",
    "Maintenir la temp√©rature du corps dans les limites normales",
    "√ätre propre, soign√© et prot√©ger ses t√©guments",
    "√âviter les dangers (S√©curit√©)",
    "Communiquer avec ses semblables",
    "Agir selon ses croyances et ses valeurs (Spiritualit√©)",
    "S'occuper en vue de se r√©aliser (Travailler/Se R√©aliser)",
    "Se r√©cr√©er, se divertir",
    "Apprendre"
];

// NOUVEAUX LEURRES : Plus de 100 faux besoins plausibles pour brouiller les pistes.
const FAUX_BESOINS = [
    // Ajouts pour la cr√©dibilit√© sociale/morale/psychologique
    "Accepter la diff√©rence",
    "Favoriser l'autonomie", // Tr√®s pi√®geux, mais concept moderne du soin
    "D√©velopper l'empathie",
    "Garantir l'√©galit√© des chances",
    "S'int√©grer socialement",
    "√ätre r√©silient face aux √©preuves",
    "Exprimer ses √©motions librement",
    "Maintenir un √©quilibre travail-vie personnelle",
    "La qu√™te du bonheur",
    "Le droit √† l'erreur",
    "L'estime de soi",
    "Avoir confiance en l'avenir",
    "Respecter les lois et les r√®gles",
    "√ätre reconnu pour ses m√©rites",
    "La tol√©rance et le dialogue",
    "Pr√©server son jardin secret",
    "La r√©gulation des conflits",
    "S'engager civiquement",
    "D√©montrer sa gratitude",
    "Le sens de l'humour",
    "La flexibilit√© cognitive",
    "√ätre √† la mode",
    "Avoir un compte en banque solide",
    "Poss√©der un v√©hicule personnel",

    // Anciens leurres et autres pi√®ges
    "Se reproduire",
    "Obtenir la reconnaissance sociale",
    "S'accepter pleinement",
    "√ätre aim√© et aimer",
    "Jouir de la libert√© absolue",
    "Atteindre la richesse",
    "Poss√©der un foyer stable",
    "Ma√Ætriser son destin",
    "Avoir un r√©seau social √©tendu",
    "Prot√©ger l'environnement",
    "D√©velopper son empathie",
    "Laisser un h√©ritage",
    "Gagner du pouvoir",
    "Voyager et d√©couvrir",
    "√ätre honn√™te en toutes circonstances",
    "Garantir son anonymat",
    "L'√©quilibre financier",
    "La beaut√© physique",
    "√ätre toujours en bonne sant√©",
    "L'immortalit√©",
    "L'autosuffisance",
    "S'exprimer artistiquement",
    "Vivre sans conflit",
    "Le respect inconditionnel",
    "L'inspiration cr√©ative",
    "L'appartenance √† une √©lite",
    "Le droit √† l'oubli",
    "L'acc√®s √† l'information illimit√©e",
    "La recherche de la perfection",
    "L'excitation et l'aventure",
    "La gratitude perp√©tuelle",
    "√âviter la souffrance",
    "Poss√©der des biens de luxe",
    "La m√©ditation quotidienne",
    "La connexion spirituelle profonde",
    "La ma√Ætrise de soi",
    "Une alimentation gastronomique",
    "L'√©loquence",
    "√ätre un leader",
    "La chance et le hasard",
    "Savoir n√©gocier",
    "L'approbation des autres",
    "Vaincre la vieillesse",
    "√âcrire un best-seller",
    "La c√©l√©brit√©",
    "La non-violence",
    "Le courage",
    "La patience",
    "La r√©silience face √† l'√©chec",
    
    // Nouveaux ajouts suppl√©mentaires pour augmenter la difficult√©
    "Le d√©veloppement personnel",
    "La gestion du stress",
    "Soutenir les plus faibles",
    "Avoir des amis fid√®les",
    "L'acc√®s √† la culture",
    "G√©rer son temps efficacement",
    "Se prot√©ger des intemp√©ries", // Pi√®geux, inclus dans la temp√©rature ou s√©curit√©, mais pas un besoin s√©par√©
    "L'√©ducation sexuelle",
    "Poss√©der un t√©l√©phone portable",
    "La libert√© d'expression",
    "√ätre √† jour dans ses connaissances",
    "Savoir s'adapter au changement",
    "La protection de l'enfance",
    "Le mentorat professionnel",
    "√âviter la solitude",
    "L'harmonie conjugale",
    "La capacit√© d'innovation",
    "Le sens des responsabilit√©s",
    "La justice sociale",
    "Se sentir utile aux autres",
    "L'attachement s√©curisant",
    "La prise de risque calcul√©e",
    "D√©velopper une pens√©e critique",
    "√ätre optimiste",
    "La curiosit√© intellectuelle"
];

const NOMBRE_AFFICHES = 6;
const needContainer = document.getElementById('need-container');
const checkBtn = document.getElementById('check-btn');
const refreshBtn = document.getElementById('refresh-btn');
const messageBox = document.getElementById('message-box');

let besoinsRestants = [...VRAIS_BESOINS];
let allBesoinOptions = [...VRAIS_BESOINS, ...FAUX_BESOINS];
let quizState = 'pending'; // 'pending', 'error', 'success'

// M√©lange un tableau de mani√®re al√©atoire (algorithme de Fisher-Yates)
function shuffle(array) {
    let currentIndex = array.length, randomIndex;
    while (currentIndex !== 0) {
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex--;
        [array[currentIndex], array[randomIndex]] = [
            array[randomIndex], array[currentIndex]];
    }
    return array;
}

// S√©lectionne les 6 besoins √† afficher, garantissant l'unicit√© et le m√©lange
function selectNeeds() {
    let selectedNeeds = [];
    let pool = [...allBesoinOptions];
    
    // 1. Assurer la pr√©sence des VRAIS besoins qui n'ont pas encore √©t√© vus
    const vraisNonVus = besoinsRestants.filter(b => VRAIS_BESOINS.includes(b));
    const nombreVrais = vraisNonVus.length > 0 ? Math.min(vraisNonVus.length, Math.ceil(Math.random() * 2)) : 0; // 0, 1 ou 2
    
    shuffle(vraisNonVus).slice(0, nombreVrais).forEach(b => {
        selectedNeeds.push({ name: b, isTrue: true });
        pool = pool.filter(item => item !== b);
    });

    // 2. Remplir le reste avec un m√©lange du pool (vieux VRAIS et tous les FAUX)
    let complementaires = shuffle(pool);
    
    // Ajout des √©l√©ments jusqu'√† 6
    let i = 0;
    while (selectedNeeds.length < NOMBRE_AFFICHES && i < complementaires.length) {
        const name = complementaires[i];
        if (!selectedNeeds.some(n => n.name === name)) {
             selectedNeeds.push({ name: name, isTrue: VRAIS_BESOINS.includes(name) });
        }
        i++;
    }

    // Assurer qu'il y a toujours 6 √©l√©ments (si la liste est trop courte)
    while (selectedNeeds.length < NOMBRE_AFFICHES) {
        const randomIndex = Math.floor(Math.random() * allBesoinOptions.length);
        const name = allBesoinOptions[randomIndex];
        if (!selectedNeeds.some(n => n.name === name)) {
             selectedNeeds.push({ name: name, isTrue: VRAIS_BESOINS.includes(name) });
        }
    }

    return shuffle(selectedNeeds);
}

// Afficher les besoins dans l'interface
function renderNeeds(needs) {
    needContainer.innerHTML = '';
    needs.forEach(need => {
        const item = document.createElement('div');
        item.className = 'need-item';
        item.dataset.need = need.name;
        item.dataset.istrue = need.isTrue;
        item.textContent = need.name;
        item.onclick = toggleSelection;
        needContainer.appendChild(item);
    });
    
    needContainer.currentNeeds = needs;
    
    messageBox.className = 'msg-info';
    if (besoinsRestants.length === 0) {
        messageBox.textContent = 'üî• **ALERTE FINALE** : Les 14 besoins sont √©puis√©s. Concentre-toi sur les leurres restants. Utilise **Poursuivre** pour valider ta s√©lection, ou **Rafra√Æchir** si la liste est st√©rile.';
    } else {
        messageBox.textContent = 'S√©lectionne tous les **vrais besoins** de V. Henderson, puis clique sur **Poursuivre** pour valider ton jugement.';
    }
    
    quizState = 'pending';
    checkBtn.disabled = false;
    refreshBtn.disabled = false;
}

// G√©rer la s√©lection/d√©s√©lection d'un besoin
function toggleSelection(event) {
    const item = event.target;
    if (quizState === 'pending') {
        item.classList.toggle('selected');
    }
}

// V√©rifier les s√©lections
function checkSelection() {
    const needItems = Array.from(needContainer.querySelectorAll('.need-item'));
    const selectedItems = needItems.filter(item => item.classList.contains('selected'));
    
    let error = false;
    let anyTrueOnScreen = needItems.some(item => item.dataset.istrue === 'true');
    let allSelectedAreTrue = true;
    let allTrueAreSelected = true;

    // Phase 1: D√©terminer les erreurs et les succ√®s
    selectedItems.forEach(item => {
        if (item.dataset.istrue === 'false') {
            // Faux s√©lectionn√© : ERREUR
            item.classList.add('incorrect');
            item.classList.remove('selected');
            error = true;
            allSelectedAreTrue = false;
        } else {
            // Vrai s√©lectionn√© : SUCC√àS
            item.classList.add('correct');
            item.classList.remove('selected');
        }
    });

    needItems.filter(item => item.dataset.istrue === 'true').forEach(item => {
        if (!item.classList.contains('correct')) {
            // Vrai manqu√© : ERREUR
            item.classList.add('incorrect'); 
            error = true;
            allTrueAreSelected = false;
        }
    });

    // Phase 2: Mise √† jour de l'√©tat (besoinsRestants) et du message
    
    // Retirer les besoins VRAIS qui ont √©t√© correctement identifi√©s pour la premi√®re fois
    needItems.filter(item => item.classList.contains('correct')).forEach(item => {
        besoinsRestants = besoinsRestants.filter(b => b !== item.dataset.need);
    });

    // D√©sactiver la possibilit√© de cliquer apr√®s v√©rification
    needItems.forEach(item => item.onclick = null);

    if (error) {
        quizState = 'error';
        messageBox.className = 'msg-error';
        let errorMsg = "‚ùå **√âchec du Criblage.** ";
        if (!allSelectedAreTrue && !allTrueAreSelected) {
             errorMsg += "Tu as manqu√© un Vrai besoin ET tu as choisi un Leurre. Les rouges signalent la faute. Clique sur **Rafra√Æchir** pour la suite.";
        } else if (!allSelectedAreTrue) {
             errorMsg += "Tu as cliqu√© sur un **leurre** (besoin non-Henderson). Le rouge indique la faute. Clique sur **Rafra√Æchir** pour la suite.";
        } else {
             errorMsg += "Un vrai besoin (signal√© en rouge) a √©t√© **manqu√©**. Le danger n'a pas √©t√© identifi√©. Clique sur **Rafra√Æchir** pour la suite.";
        }
        messageBox.textContent = errorMsg;
        checkBtn.disabled = true; 
    } else {
        // Succ√®s ou absence de Vrai besoin
        quizState = 'success';
        messageBox.className = 'msg-info';
        if (anyTrueOnScreen) {
             messageBox.textContent = "‚úÖ **Sans faute !** Tous les vrais besoins ont √©t√© identifi√©s. Clique sur **Poursuivre** pour le prochain cycle de criblage.";
        } else {
             messageBox.textContent = "‚úÖ **St√©rile.** Le champ √©tait vide de vrais besoins. Clique sur **Poursuivre** pour le prochain cycle de criblage.";
        }
        
        if (besoinsRestants.length === 0) {
             messageBox.textContent += " La liste des 14 besoins de V. Henderson est **√©puis√©e**. Continuez √† cribler les leurres.";
        }
    }
}

// G√©rer le rafra√Æchissement
function handleRefresh() {
    const needItems = Array.from(needContainer.querySelectorAll('.need-item'));
    const anyTrueOnScreen = needItems.some(item => item.dataset.istrue === 'true');
    const selectedItems = needItems.filter(item => item.classList.contains('selected'));

    if (selectedItems.length > 0) {
        // Tentative de Rafra√Æchissement avec des s√©lections actives
        messageBox.className = 'msg-error';
        messageBox.textContent = "‚ùå **Fausse Man≈ìuvre.** Tu as s√©lectionn√© des √©l√©ments. Utilise **Poursuivre** pour valider/v√©rifier d'abord.";
        checkBtn.disabled = false; // Permettre de revenir √† la v√©rification
        return;
    }

    if (anyTrueOnScreen && quizState === 'pending') {
        // Erreur critique : Il y avait des Vrais besoins, l'utilisateur a voulu Rafra√Æchir sans valider.
        messageBox.className = 'msg-error';
        messageBox.textContent = "‚ùå **√âchec Critique.** Tu as voulu **Rafra√Æchir**, mais il restait des **vrais besoins** √† trouver ! Le danger √©tait r√©el. Ils sont marqu√©s en rouge (manqu√©s). Clique sur **Rafra√Æchir** √† nouveau pour passer au cycle suivant.";
        needItems.filter(item => item.dataset.istrue === 'true').forEach(item => {
            item.classList.add('incorrect');
            item.onclick = null;
        });
        checkBtn.disabled = true;
        quizState = 'error'; // Marquer l'√©tat comme erreur pour le refresh suivant
    } else {
        // Succ√®s du Rafra√Æchissement (ou Rafra√Æchissement apr√®s une erreur Check)
        messageBox.className = 'msg-info';
        messageBox.textContent = "üîÑ **Rafra√Æchissement Forc√©.** Un nouveau cycle s'ouvre. Crible √† nouveau.";
        renderNeeds(selectNeeds());
    }
}

// D√©marrer l'application
function init() {
    checkBtn.onclick = checkSelection;
    refreshBtn.onclick = handleRefresh;
    
    // Le bouton Poursuivre passe au set suivant apr√®s un succ√®s
    checkBtn.addEventListener('click', () => {
        if (quizState === 'success') {
            renderNeeds(selectNeeds());
        }
    });

    renderNeeds(selectNeeds());
}

init();
</script>
</body>
</html>